{% extends 'base.html.twig' %}

{% block title %}BH Cruceros{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Montserrat:300%7CQuestrial">
    <link rel="stylesheet" href="{{ asset('css/bootstrap.css') }}">
    <link rel="stylesheet" href="{{ asset('css/fonts.css') }}">
    <link rel="stylesheet" href="{{ asset('css/cruceros.css') }}">
    <style>
      .ie-panel{
      display: none;
      background: #212121;
      padding: 10px 0;
      box-shadow: 3px 3px 5px 0 rgba(0,0,0,.3);
      clear: both;
      text-align:center;
      position: relative;
      z-index: 1;
      } 
      html.ie-10 .ie-panel,html.lt-ie-10 .ie-panel {
      display: block;
      }
    </style>
{% endblock %}

{% block content %}
<style>
  p{
    color: #000000;
    font-weight: 700;
  }
</style>

<h1>Información del crucero</h1>
<p>Nombre del crucero: {{ crucero.nombre }}</p>
<p>Destino del crucero: {{ crucero.destino }}</p>
<p>Descripción del crucero: {{ crucero.descripcion }}</p>
<p>Puerto de salida: {{ crucero.puertoDeSalida }}</p>
<p>Puerto de llegada: {{ crucero.puertoDeLlegada }}</p>
<p>Fecha de salida: {{ crucero.fechaDeSalida|date('d/m/Y') }}</p>
<p>Fecha de llegada: {{ crucero.fechaDeLlegada|date('d/m/Y') }}</p>
{% for tipo in tipos %}
  {% if tipo.id == crucero.tipo.id %}
      <p class="card-text">Tipo: {{ tipo.nombre }}</p>
  {% endif %}
{% endfor %}
<hr>

<form id="reservaForm" action="{{ path('privatereservar_crucero', {'cruceroId': crucero.id}) }}" method="POST">
  <h2>Información de los camarotes</h2>
  <select name="camarote" id="camaroteSelect">
    <option>Seleccione un camarote</option>
    {% for camarote in camarotes %}
      <option value="{{ camarote.id }}" data-precio="{{ camarote.precio }}">
        {{ camarote.nombre }} - ({{ camarote.precio }} € {{ camarote.descripcion }})
      </option>
    {% endfor %}
  </select>
  <br><br>

  <h2>Información de los servicios</h2>
  <select name="servicio" id="servicioSelect">
    <option>Seleccione un servicio</option>
    {% for servicio in servicios %}
      <option value="{{ servicio.id }}" data-precio="{{ servicio.precio }}">
        {{ servicio.nombre }} - ({{ servicio.precio }} € {{ servicio.descripcion }})
      </option>
    {% endfor %}
  </select>
  <br><br>

  <p id="sumaTexto">Precio total: 0 €</p>

  <button id="confirmButton" disabled>Confirmar</button>
</form>

<script>
  const camaroteSelect = document.getElementById('camaroteSelect');
  const servicioSelect = document.getElementById('servicioSelect');
  const sumaTexto = document.getElementById('sumaTexto');
  const confirmButton = document.getElementById('confirmButton');

  // Habilitar el botón "Confirmar" cuando se seleccione un valor en ambos formularios
  camaroteSelect.addEventListener('change', calcularSuma);
  servicioSelect.addEventListener('change', calcularSuma);

  function calcularSuma() {
    const camarotePrecio = parseFloat(camaroteSelect.options[camaroteSelect.selectedIndex].getAttribute('data-precio'));
    const servicioPrecio = parseFloat(servicioSelect.options[servicioSelect.selectedIndex].getAttribute('data-precio'));
    const suma = camarotePrecio + servicioPrecio;
    sumaTexto.textContent = 'Suma: ' + suma + ' €';

    if (camaroteSelect.value !== 'Seleccione un camarote' && servicioSelect.value !== 'Seleccione un servicio') {
      confirmButton.disabled = false;
    } else {
      confirmButton.disabled = true;
    }
    const sumaInput = document.getElementById('sumaInput');
    sumaInput.value = suma;
  }

  // Enviar el formulario cuando se haga clic en "Confirmar"
  confirmButton.addEventListener('click', () => {
    const reservaForm = document.getElementById('reservaForm');
    reservaForm.submit();
  });
</script>


{% endblock %}
